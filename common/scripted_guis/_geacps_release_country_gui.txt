scripted_gui = {
	project_F_kikan_btn = {#表示ボタン
		window_name = "project_F_kikan_btn" 
		context_type = player_context 
		visible = { 
		}
		effects = {
			pfk_open_btn_click = {

				if = {
					limit = { has_country_flag = pfk_on }
					clr_country_flag = pfk_on
				}
				else = {
					set_country_flag = pfk_on
					clear_array = ROOT.pfk_array
					for_each_loop = {#陣営ごとに
						array = global.pfk_country_array
						value = country_tag
						index = index_num
						add_to_array = { ROOT.pfk_array = country_tag }
					}
				}
			}
		}
		properties = {
		}
		triggers = {	#ボタンを実行できる条件?
		}
	}
	project_F_kikan_GUI = {#
		window_name = "project_F_kikan_GUI" 
		context_type = player_context 
		visible = { 
			is_ai = no
			has_country_flag = pfk_on
		}
		effects = {
			#デバック
			pfk_open_btn_0_click = {#リセット
				pfk_first_setting = yes
				for_each_scope_loop = {#陣営ごとに
					array = global.countries
					clear_array = pfk_country_array
				}
				clear_array = global.pfk_country_array
				clear_array = ROOT.pfk_array
				clear_array = ROOT.pfk_current_country_list
				clear_variable = ROOT.pfk_current_target
				set_pfk_country_arraies = yes
				
				for_each_loop = {#陣営ごとに
					array = global.pfk_country_array
					value = country_tag
					index = index_num
					add_to_array = { ROOT.pfk_array = country_tag }
				}
			}
			pfk_open_btn_1_click = {#一つ戻る
				clear_array = ROOT.pfk_array
				if = {	#国家選択中
					limit = { check_variable = { ROOT.pfk_setting_progress = 0 } }
					remove_from_array = {
						array = ROOT.pfk_current_country_list
						index = 0
					}
					set_temp_variable = { current_scope = ROOT.pfk_current_country_list^0 }
					if = {#一つ前のネストに戻る
						limit = { has_variable = ROOT.pfk_current_country_list^0 }
						var:current_scope = {
							for_each_loop = {
								array = pfk_country_array
								value = country_tag
								index = index_num
								add_to_array = { ROOT.pfk_array = country_tag }
							}
						}
						set_variable = { ROOT.pfk_current_target = current_scope }
					}
					else = {#ネストが最も浅い
						for_each_loop = {
							array = global.pfk_country_array
							value = country_tag
							index = index_num
							add_to_array = { ROOT.pfk_array = country_tag }
						}
						set_variable = { ROOT.pfk_current_target = ROOT }
					}	
				}
				else_if = { #自治度設定
					limit = { check_variable = { ROOT.pfk_setting_progress = 1 } }
					if = {#一つ前のネストに戻る
						limit = {
							OR = {
								check_variable = { ROOT.pfk_current_target = token:pfk_method_puppet }
								check_variable = { ROOT.pfk_current_target = token:pfk_method_protected_state }
								check_variable = { ROOT.pfk_current_target = token:pfk_method_colony }
								check_variable = { ROOT.pfk_current_target = token:pfk_method_colony_JAP }
								check_variable = { ROOT.pfk_current_target = token:pfk_method_colony_GER }
								check_variable = { ROOT.pfk_current_target = token:pfk_method_colony_SOV }
								check_variable = { ROOT.pfk_current_target = token:pfk_method_return }
								check_variable = { ROOT.pfk_current_target = token:pfk_method_incorporation }
							}
						}
						pfk_set_autonomy = yes
					}
					esle = {#国家選択画面へ戻る
						set_temp_variable = { current_scope = ROOT.pfk_current_country_list^0 }
						var:current_scope = {
							for_each_loop = {
								array = pfk_country_array
								value = country_tag
								index = index_num
								add_to_array = { ROOT.pfk_array = country_tag }
							}
						}
						set_variable = { ROOT.pfk_current_target = current_scope }
						set_variable = { ROOT.pfk_setting_progress = 0 }
					}
				}
			}
			pfk_open_btn_2_click = {
				var:pfk_current_target = {
					ROOT = {
						every_owned_state = {
							limit = {
								is_in_array = {
									array = PREV.PREV.pfk_state_array_1
									value = THIS
								}
							}
							transfer_state_to = PREV.PREV
						}	
					}
				}
			}
			pfk_open_btn_3_click = {	
			}
			pfk_open_btn_4_click = {
			}
			pfk_selected_btn_click = {
				log = "現在:[?THIS.GetName]"
				if = {
					limit = { NOT = { check_variable = { ROOT.pfk_current_country_list^0 = THIS } }  }#現在選択中の対象が選択した国家と一致
					if = {#国家選択中
						limit = { check_variable = { ROOT.pfk_setting_progress = 0 } }
						if = {#
							limit = { has_variable = pfk_country_array^0 }#選択した国家に下位国家のリストがあるか
							clear_array = ROOT.pfk_array
							add_to_array = {
								array = ROOT.pfk_current_country_list
								value = v
								index = 0
							}
							for_each_loop = {#
								array = pfk_country_array
								value = country_tag
								index = index_num
								add_to_array = { ROOT.pfk_array = country_tag }
							}				
						}
						set_variable = { ROOT.pfk_current_target = v }
					}
					else_if = {#自治度選択した
						limit = { check_variable = { ROOT.pfk_setting_progress = 1 } }
						add_ideas = var:v
						remove_ideas =  var:v
						set_variable = { ROOT.pfk_current_target = v }
					}
				}

			}
			pfk_set_btn_click = {
				if = {#国家の選択
					limit = {
						check_variable = { ROOT.pfk_setting_progress = 0 }
						has_variable = ROOT.pfk_current_target
					}
					set_variable = { ROOT.pfk_setting_list^0 = ROOT.pfk_current_target } #決まったことリスト0番目:対象の国
					clear_variable = ROOT.pfk_current_target
					#進行度を自治度へ
					set_variable = { ROOT.pfk_setting_progress = 1 }
					#表示する候補をセット
					pfk_set_autonomy = yes
				}
				else_if = {#自治度を設定
					limit = {
						check_variable = { ROOT.pfk_setting_progress = 1 }
						has_variable = ROOT.pfk_current_target
					}
					set_variable = { ROOT.pfk_setting_list^1 = ROOT.pfk_current_target }#傀儡レベルを固定
					clear_array = ROOT.pfk_array
					add_ideas = var:pfk_current_target
					remove_ideas =  var:pfk_current_target
					clear_variable = ROOT.pfk_current_target
					
				}
				else_if = {#国名を設定
					limit = {
						check_variable = { ROOT.pfk_setting_progress = 2 }
						has_variable = ROOT.pfk_current_target
					}
					clear_array = ROOT.pfk_array
					add_ideas = var:pfk_current_target
					remove_ideas =  var:pfk_current_target
					clear_variable = ROOT.pfk_current_target
					set_variable = { ROOT.pfk_setting_progress = 3 }
				}
			}
		}
		triggers = {
			pfk_selected_btn_click_enabled = {
				# has_variable = pfk_country_array^0
				# NOT = {
				# 	any_of_scopes = {
				# 		array = pfk_state_array_1
				# 		value = v
				# 		index = i
				# 		OR = {
				# 			is_core_of = ROOT
				# 			is_claimed_by = ROOT
				# 		}
				# 	}
				# }
			}
			pfk_open_btn_1_click_enabled = {
				has_variable = ROOT.pfk_current_country_list^0
			}
			pfk_star_icon_visible = {
				# has_variable = pfk_country_array^0
				any_of_scopes = {
					array = pfk_state_array_1
					is_owned_by = ROOT
				}
			}
		}
		properties = {

		}
		dynamic_lists = {
			pfk_country_list_gridbox = {
				array = ROOT.pfk_array
				change_scope = yes
				entry_container = pfk_target_country_container
			}
			pfk_current_country_list_gridbox = {
				array = ROOT.pfk_current_country_list
				change_scope = yes
				entry_container = pfk_current_country_list_container	
			}
			pfk_setting_list_gridbox = {
				array = ROOT.pfk_setting_list
				change_scope = no
				entry_container = pfk_setting_list_container
			}			
		}
	}

}
